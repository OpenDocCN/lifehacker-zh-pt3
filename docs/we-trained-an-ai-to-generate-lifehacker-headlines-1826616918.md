# 如何训练自己的神经网络

> 原文：<https://lifehacker.com/we-trained-an-ai-to-generate-lifehacker-headlines-1826616918>

如今，人工智能(AI)似乎已经准备好运行世界的大部分地区:它是检测皮肤癌的，在脸书寻找仇恨言论的，甚至是西班牙警方报告中可能存在的。但是人工智能并不都是由大公司和政府经营的；你可以下载一些算法，自己玩，往往会有爆笑的结果。

Watch

有一张 [假 Coachella 海报，上面满是假乐队名](http://digg.com/2018/coachella-lineup-ai-band-names) ，这是通过将一堆真实的乐队名输入神经网络，并要求它想出一些自己的名字来创建的。还有以类似方式创造的 [食谱](https://gist.github.com/nylki/1efbaa36635956d35bcc) ，其中“烧烤牛肉”需要“1 杯啤酒——切成方块”然后还有我最喜欢的，Janelle Shane 的 [AI 生成的颜料颜色](http://aiweirdness.com/post/160776374467/new-paint-colors-invented-by-neural-network) (自己标记，我是多克伍德)。

这些都是用 [神经网络](https://en.wikipedia.org/wiki/Artificial_neural_network) 制造的，这是一种模仿我们大脑类似网络性质的人工智能。你通过给神经网络输入来训练它:比如食谱。随着网络的学习，它会比其他神经元(模拟脑细胞)更多地加强其神经元之间的一些连接。这个想法是，它计算出输入如何工作的规则:例如，哪些字母倾向于跟随其他字母。一旦网络被训练，你可以要求它生成自己的输出，或者给它一部分输入，要求它填充其余的。

但是计算机实际上并不理解比如说制作食谱的规则。它知道啤酒可以是一种配料，知道东西可以切成方块，但是从来没有人告诉它啤酒不是那种东西。看起来几乎正确，但误解了一些基本规则的输出往往是最搞笑的。

我很高兴只是远远地看着这些滑稽动作，直到谢恩在推特上提到，一个中学编码班的 [生成了比她更好的冰淇淋名字](http://aiweirdness.com/post/173797162852/ai-scream-for-ice-cream) 。我想，如果*的孩子们*能做到这一点，我也能做到。

### 如何训练你的第一个神经网络

我开始使用 Shane 用于冰淇淋口味的相同工具包:Buzzfeed 的 Max Woolf 开发的名为 [textgenrnn](https://github.com/minimaxir/textgenrnn) 的 python 模块。你需要一个 [命令行](https://lifehacker.com/a-command-line-primer-for-beginners-5633909) 的基础知识来使用它，但是它可以在任何安装了编程语言/解释器 [python](https://www.python.org/) 的系统(Mac、Linux、Windows)上工作。

在你训练自己的神经网络之前，你需要一些输入。举例来说，中学班级从数千种冰淇淋口味的清单开始。无论你选择什么，你至少需要几百个例子；几千会更好。也许你想 [下载你所有的推文](https://help.twitter.com/en/managing-your-account/how-to-download-your-twitter-archive) ，并要求网络为你生成一些新推文。或者查看一下 [维基百科的列表列表](https://en.wikipedia.org/wiki/List_of_lists_of_lists) 中的想法。

无论你选择什么，把它放到一个文本文件中，每行一个条目。这可能需要一些创造性的复制粘贴或电子表格工作，或者如果您是编码老手，您可以编写一些难看的 perl 脚本来提交数据。我是一个丑陋的 perl 脚本类型的女孩，但当我最终想要我的一个数据集的 Lifehacker 标题时，我只是要求我们的分析团队提供一个大的标题列表，他们给我发了电子邮件，正是我需要的。友好地询问是一种被低估的编码技能。

(如果你想把 Lifehacker 的头条新闻输入你自己的神经网络， [下面是这个列表。大概有一万只](https://www.scribd.com/document/381194025/Ten-Thousand-Lifehacker-Headlines) 。)

为您的新项目创建一个文件夹，并编写两个脚本。首先是一个叫 train.py 的:

```
from textgenrnn import textgenrnn
t = textgenrnn()
t.train_from_file(‘input.txt’, num_epochs=5)
```

这个脚本将让神经网络读取你的输入，并思考它的规则必须是什么。该脚本有几处可以修改:

*   `t = textgenrnn()`第一次运行该脚本时很好，但是如果您想以后再运行它，请输入运行它时神奇地出现在文件夹中的. hdf5 文件的名称。在这种情况下，该行应该是这样的:`t=textgenrnn(‘textgenrnn_weights.hdf5’)`
*   `‘input.txt’`是你的文件名，每行一个标题/食谱/推文/等等。
*   `num_epochs`是您想要处理文件的次数。你让神经网络学习的时间越长，它就会变得越好，所以从 2 或 5 开始，看看需要多长时间，然后从那里向上。

训练网络需要一段时间。如果您在笔记本电脑上运行脚本，一个时期可能需要 10 或 15 分钟(更大的数据集需要更长时间)。如果你有一个结实的台式机，也许是你或朋友的游戏电脑，事情会进行得更快。如果你有一个大的数据集，你可能想让它运行几十甚至几百个时期，然后让它通宵运行。

接下来，编写另一个名为 spit_out_stuff.py 的脚本(您可以随意给这些脚本起比我更好的名字):

```
from textgenrnn import textgenrnn
t = textgenrnn(‘textgenrnn_weights.hdf5')
t.generate(20, temperature=0.5)
```

这是有趣的部分！上面的脚本会给你 20 个有趣的新事物。最后一行的重要部分是:

*   要生成的东西的数量:这里是 20。
*   温度，就像一个创意刻度盘。值为 0.1 时，您将获得非常基本的输出，这可能比您输入的内容更无聊。在 1.0 版本中，输出会变得非常有创造性，以至于经常输出的甚至不是真正的单词。如果你敢，你可以比 1.0 更高。

当您运行训练脚本时，您会注意到它显示了不同温度下的样本输出，因此您可以使用它来指导您运行多少个时期，以及您希望使用什么温度来生成您的最终输出。

并不是你的神经网络想出的每个想法都是喜剧黄金。你得自己挑选最好的。以下是我的人工智能想到的一些更好的 Lifehacker 标题:

> **制作婴儿笔记本电脑的最佳方式**
> 
> **如何在退格饮酒游戏中生存**
> 
> **求职面试的最佳方式**
> 
> **如何用这张方便的图片点燃你人生中最棒的篝火**
> 
> **如何制作自己的播客吧**
> 
> **如果你是 Arduino 用户，如何获得新的 iPhone X**
> 
> **如何在博物馆清理自己的尺寸**
> 
> **如何开始讲述你的故事和焦虑**
> 
> **冬季自制墨水的最佳方式**
> 
> **如何与一个想象的概念保持关系**
> 
> **用树莓酱制作一杯完美葡萄酒的最佳方式**
> 
> **吃厕所草莓的最佳方式**
> 
> 如何在假期找到一份更好的工作
> 
> **吃掉一个顽固罐子的最好方法**

我通过玩温度和训练时期的数量得到这些，每次我看到我喜欢的东西，我就把它复制到我最喜欢的文本文件中。我还对算法的逐字版本进行了实验；上面的脚本使用默认的逐字符模型。我最后列出的标题包括了两者的结果。

如果你对一些废品感到好奇，这里是我在 0.1 的温度下得到的结果:

> **保持流媒体停止的最佳方式让你的手机变得更加另类**
> 
> **当你不需要了解这个世界的时候，最好的方法就是发挥最大的力量**
> 
> **留下来的最好方法开始留下来开始你阻止任何人的常用方法**
> 
> **如何以最佳方式查看最受欢迎的帖子**
> 
> **入住的最佳方式开始制作您的手机**

如果我把它调到 1.5(危险的创造性):

> **今日剩余:如何找到不重要的东西**
> 
> **更新旅行记录卡、烤箱记录卡或“旅行记录卡”**
> 
> **风险意识不可复制，聚焦 Zoomitas**
> 
> **Ifo 去了 Vape Texts Battery Oro cred iblacy supreme buldsweoapoties**
> 
> **DIY 烧烤现在可以添加我的 Hises Uniti 来传播您的话语**

显然，需要人类的帮助。

### 成为你的人工智能的伙伴

尽管神经网络可以从数据集学习，但它们并不真正理解发生了什么。这就是为什么一些最好的结果来自于人和机器之间的合作。“我知道这是我使用的一个工具，”詹妮尔·谢恩说，“但很难不把它想成——‘来吧，小神经网络，你能做到’和‘哦，这很聪明’或‘你越来越困惑了，可怜的小东西。’

为了充分利用你的关系，你必须引导你的人工智能伙伴。有时候，它可能非常擅长猜测你的数据集规则，以至于它只是重现了你喂它的东西——人工智能版的抄袭。你必须检查它有趣的输出是真正的原创。

伯特尼克工作室 通过训练预测文本键盘将人与机器配对。想象一下，如果你拿起你朋友的电话，通过使用他们键盘上的预测文本输入信息。你最终会写下你自己的信息，但是读起来像你朋友的风格。同样的，你可以用你喜欢的任何数据源 [训练一个 Botnik 键盘](http://botnik.org/tutorial.html) ，然后用键盘提供的单词进行书写。这就是 [这个惊人的建议专栏决斗](https://www.reddit.com/r/botnik/comments/8i7bb0/ask_them_anything_dear_abby_vs_savage_love/) 的由来:两个在《野蛮之爱》和《亲爱的艾比》上训练的 Botnik 键盘。

如果你更喜欢与你的算法伙伴对抗，而不是合作，看看 Janelle Shane 是如何搞怪一个神经网络的，这个网络起初似乎擅长识别在牧场上吃草的绵羊。她 PS 出了绵羊，并意识到人工智能只是在草丛中寻找白色斑点。如果她把羊涂成橙色，人工智能会认为它们是花。于是她 [向她的推特粉丝](https://twitter.com/janellecshane/status/969239712190746624?lang=en) 询问不寻常地方的绵羊，而 [发现](http://aiweirdness.com/post/171451900302/do-neural-nets-dream-of-electric-sheep) 人工智能认为车里的绵羊一定是狗，树上的山羊一定是鸟，厨房里的绵羊一定是猫。

 [https://lifehacker.com/embed/inset/iframe?id=twitter-969239712190746624&autosize=1](https://lifehacker.com/embed/inset/iframe?id=twitter-969239712190746624&autosize=1) 

严肃的人工智能可能会有类似的问题，为了好玩而玩算法可以帮助我们理解为什么它们如此容易出错。例如，一个早期皮肤癌检测人工智能意外地学习了区分癌性和良性皮肤病变的错误规则。当医生发现一个大的病变时，他们通常会在尺子旁边拍照以显示大小。人工智能 [无意中教会了自己](https://www.thedailybeast.com/why-doctors-arent-afraid-of-better-more-efficient-ai-diagnosing-cancer) 识别癌症肿瘤很容易:只要找把尺子就行了。

我们可以学到的另一个教训是，算法的输出取决于你输入的数据。ProPublica 发现，在判决中使用的一种算法对黑人被告比对白人被告更严厉 。它没有考虑种族因素，但它的输入导致它错误地认为，黑人被告的共同犯罪和背景比白人被告的犯罪和背景更能预示重犯。这台计算机不知道种族的概念，但如果你的输入数据反映了一种偏见，计算机最终会延续这种偏见。我们最好理解算法的这种局限性，不要因为它们不是人类就认为它们一定是公正的。(祝你的仇恨演讲好运 AI，脸书！)

### 混淆你的数据集

没有必要停留在一个数据集上；你可以把它们两个混在一起，看看会有什么结果。(例如，我 [组合了 Goop 和 Infowars 商店的产品列表](https://twitter.com/BethSkw/status/996223171874324481) 。微微 NSFW。)

你也可以训练一个分类算法。谢恩说她已经有了一份金属乐队的名单和我的小马的名字，所以她训练了一个分类器来区分 T2 和 T3。(Pinky Doom:99%金属。)一旦你有了一个训练好的分类器，你就可以向它输入任何东西并得到一个读数。本尼迪克特·康伯巴奇:96%金属。

 [https://lifehacker.com/embed/inset/iframe?id=twitter-999685288396926977&autosize=1](https://lifehacker.com/embed/inset/iframe?id=twitter-999685288396926977&autosize=1) 

你也可以把你喜欢的任何东西输入到一个经过训练的 textgenrnn 网络中。当你指定你想要多少物品，网络要用什么温度(创意)的时候，你也可以给它一个前缀。然后，它会尝试找出应该跟在该前缀后面的单词。在我训练了 Lifehacker 的标题之后，我让人工智能给我以“三要素快乐时光”开头的标题。它用一些美妙的虚构鸡尾酒作为回应(同样，这些是我从一长串清单中挑选出来的):

> 3 种成分的快乐时光:草药压力升级
> 
> 快乐时光三要素:蛋糕的稻草
> 
> 快乐时光三要素:黑锅
> 
> 快乐时光的三大要素:披萨和饮料，因为他们是商人的翅膀
> 
> 快乐时光三要素:费伦特锅
> 
> 快乐时光的 3 种成分:润喉提神
> 
> 快乐时光 3 要素:最佳酒吧点餐
> 
> 快乐时光三要素:剩余派对控制
> 
> 快乐时光三要素:夏季朗姆酒切割
> 
> 快乐时光:最好的椰子
> 
> 三要素快乐时光:美丽的石林
> 
> 快乐时光的三大要素:厚脸皮糖果

如果你在未来的 Lifehacker 帖子中看到这些，不要感到惊讶；我们的食品和饮料编辑克莱尔·洛说她想尝试做一些这样的东西。

但是我没有等待她的专业食谱，而是决定将这些也输入到一个神经网络中。我从 [Chris Lowder 的鸡尾酒指南](https://www.finedininglovers.com/blog/food-drinks/chris-lowder-cocktail-guide/) 和 [WikiBooks 鸡尾酒词汇表](https://en.wikibooks.org/wiki/Bartending/Cocktails/Glossary) 中收集了一些鸡尾酒食谱，并对它们进行了排列，以便每种鸡尾酒占据一行文本文件，以鸡尾酒的标题作为开头几个词。这意味着我可以选择一种鸡尾酒的名字，并要求我的鸡尾酒训练神经网络提供接下来的食谱。以下是一些结果:

> 最好的椰子酱。本笃会 E1 破折号芳香 b. < 1 盎司。蔓越莓 d. .5 盎司。大约 75 盎司的柠檬。Iteloun d. 2 dashes Juponged Slipes i .搅拌/过滤/Coupe/无装饰
> 
> 奇奇糖果 1 . 1 盎司。布伦戴雪利 b. 1.5 盎司。新鲜菠萝 d .朗斯廷白兰地碗 De 有在大牙买加 c. 2 破折号菠萝 d. 1 破折号芳香苦味剂 E1 破折号芳香杜松子酒二。1 盎司。伏特加 ii。0.5 盎司。陈年朗姆酒，2 份安古斯图拉苦味酒，搅拌/过滤/尼克和诺拉玻璃杯/冰/1
> 
> 费伦特锅 1.25 盎司。绿色黄绿色 1.5 盎司。伦敦干杜松子酒 b. .75 盎司。填充威士忌 b .橙半威士忌

当然，你可以向它索要任何东西:

> 贝丝 Skwarecki - 1 盎司。混合苏格兰(果汁)水 b. 1 盎司。蛋白在大岩石玻璃与 dets 1934 或使巴比诺
> 
> 生活黑客 c. 14 伏特加马丁尼。金巴利一号奶昔/精酿/双门跑车/柠檬皮

输入的数据只有几百种鸡尾酒配方，所以我不得不把温度调得更高一些。而在高温下(这里是 1.0)，有时候你得到的单词并不是真正的单词。祝你在商店里找到朗斯汀白兰地或布兰德雪利酒——但是如果你找到了，我的宠物 AI 会很高兴的。